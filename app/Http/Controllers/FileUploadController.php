<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;

class FileUploadController extends Controller
{
    public function upload(Request $request): \Illuminate\Http\JsonResponse
    {
        if (!$request->hasFile('file') || !$request->file('file')->isValid()) {
            return response()->json(['message' => 'Invalid or missing file'], 400);
        }
        $content = file($request->file('file')->getRealPath(), FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
        $svgFiles = array_map(fn($line) => $this->generateSvg(trim($line)), $content);

        return response()->json(array_filter($svgFiles));
    }

    private function generateSvg($content)
    {
        return <<<SVG
<svg xmlns="http://www.w3.org/2000/svg"
 width="174.000000pt" height="173.000000pt" viewBox="0 0 174.000000 173.000000"
 preserveAspectRatio="xMidYMid meet">

<g transform="translate(0.000000,173.000000) scale(0.100000,-0.100000)"
fill="#000000" stroke="none">
<path d="M27 1703 c-4 -3 -7 -129 -7 -280 l0 -273 280 0 280 0 0 280 0 280
-273 0 c-151 0 -277 -3 -280 -7z m483 -278 l0 -205 -205 0 -205 0 0 205 0 205
205 0 205 0 0 -205z"/>
<path d="M180 1430 l0 -120 120 0 120 0 0 120 0 120 -120 0 -120 0 0 -120z"/>
<path d="M830 1670 l0 -40 -80 0 -80 0 0 -40 0 -40 80 0 80 0 0 -40 0 -40 -80
0 -80 0 0 -40 0 -40 40 0 40 0 0 -40 0 -40 -40 0 -40 0 0 -85 0 -85 40 0 40 0
0 -40 0 -40 -120 0 -120 0 0 -40 0 -40 40 0 40 0 0 -40 0 -40 -165 0 -165 0 0
40 0 40 80 0 80 0 0 40 0 40 -200 0 -200 0 0 -40 0 -40 40 0 40 0 0 -40 0 -40
-40 0 -40 0 0 -120 0 -120 40 0 40 0 0 80 0 80 40 0 40 0 0 -80 0 -80 80 0 80
0 0 40 0 40 -40 0 -40 0 0 40 0 40 165 0 165 0 0 -40 0 -40 -40 0 -40 0 0 -40
0 -40 80 0 80 0 0 -80 0 -80 40 0 40 0 0 -40 0 -40 -40 0 -40 0 0 -200 0 -200
40 0 40 0 0 80 0 80 120 0 120 0 0 40 0 40 40 0 40 0 0 -40 0 -40 80 0 80 0 0
-40 0 -40 -40 0 -40 0 0 -40 0 -40 40 0 40 0 0 40 0 40 120 0 120 0 0 -40 0
-40 80 0 80 0 0 40 0 40 40 0 40 0 0 40 0 40 -80 0 -80 0 0 -40 0 -40 -40 0
-40 0 0 40 0 40 -40 0 -40 0 0 40 0 40 120 0 120 0 0 40 0 40 40 0 40 0 0 80
0 80 -40 0 -40 0 0 40 0 40 -40 0 -40 0 0 80 0 80 -40 0 -40 0 0 -40 0 -40
-80 0 -80 0 0 40 0 40 40 0 40 0 0 40 0 40 -40 0 -40 0 0 120 0 120 -40 0 -40
0 0 -80 0 -80 -40 0 -40 0 0 80 0 80 -40 0 -40 0 0 -40 0 -40 -40 0 -40 0 0
40 0 40 -40 0 -40 0 0 -40 0 -40 40 0 40 0 0 -200 0 -200 -40 0 -40 0 0 120 0
120 -80 0 -80 0 0 -40 0 -40 40 0 40 0 0 -40 0 -40 -80 0 -80 0 0 120 0 120
40 0 40 0 0 80 0 80 40 0 40 0 0 40 0 40 40 0 40 0 0 40 0 40 40 0 40 0 0 -40
0 -40 40 0 40 0 0 40 0 40 -40 0 -40 0 0 45 0 45 40 0 40 0 0 200 0 200 -120
0 -120 0 0 -40z m160 -80 l0 -40 -40 0 -40 0 0 40 0 40 40 0 40 0 0 -40z m0
-200 l0 -80 -40 0 -40 0 0 -45 0 -45 -40 0 -40 0 0 -40 0 -40 -40 0 -40 0 0
85 0 85 40 0 40 0 0 80 0 80 80 0 80 0 0 -80z m240 -610 l0 -40 -40 0 -40 0 0
40 0 40 40 0 40 0 0 -40z m80 -200 l0 -80 -40 0 -40 0 0 40 0 40 -40 0 -40 0
0 -40 0 -40 -40 0 -40 0 0 -40 0 -40 -80 0 -80 0 0 -40 0 -40 40 0 40 0 0 -40
0 -40 -40 0 -40 0 0 40 0 40 -40 0 -40 0 0 -40 0 -40 -40 0 -40 0 0 40 0 40
40 0 40 0 0 80 0 80 -40 0 -40 0 0 40 0 40 40 0 40 0 0 -40 0 -40 120 0 120 0
0 40 0 40 40 0 40 0 0 40 0 40 80 0 80 0 0 -80z m240 -40 l0 -40 40 0 40 0 0
-80 0 -80 -40 0 -40 0 0 80 0 80 -80 0 -80 0 0 40 0 40 80 0 80 0 0 -40z
m-160 -200 l0 -80 -40 0 -40 0 0 -40 0 -40 -40 0 -40 0 0 40 0 40 -40 0 -40 0
0 40 0 40 40 0 40 0 0 40 0 40 80 0 80 0 0 -80z"/>
<path d="M1230 300 l0 -40 40 0 40 0 0 40 0 40 -40 0 -40 0 0 -40z"/>
<path d="M1150 1430 l0 -280 280 0 280 0 0 280 0 280 -280 0 -280 0 0 -280z
m480 -5 l0 -205 -200 0 -200 0 0 205 0 205 200 0 200 0 0 -205z"/>
<path d="M1310 1430 l0 -120 120 0 120 0 0 120 0 120 -120 0 -120 0 0 -120z"/>
<path d="M1390 980 l0 -80 120 0 120 0 0 -40 0 -40 40 0 40 0 0 80 0 80 -40 0
-40 0 0 40 0 40 -40 0 -40 0 0 -40 0 -40 -40 0 -40 0 0 40 0 40 -40 0 -40 0 0
-80z"/>
<path d="M20 300 l0 -280 280 0 280 0 0 280 0 280 -280 0 -280 0 0 -280z m490
0 l0 -200 -205 0 -205 0 0 200 0 200 205 0 205 0 0 -200z"/>
<path d="M180 300 l0 -120 120 0 120 0 0 120 0 120 -120 0 -120 0 0 -120z"/>
<path d="M910 60 l0 -40 80 0 80 0 0 40 0 40 -80 0 -80 0 0 -40z"/>
</g>
</svg>
SVG;
    }
}
